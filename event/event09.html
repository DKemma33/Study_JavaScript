<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fetch</title>
    <style>
      h1 {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      
      #gallery {
        margin: 0 auto;
        display: flex;
        width: 950px;
        flex-wrap: wrap;
      }

      div.gallery-item {
        padding: 0 20px;
        width: 150px;
        height: 300px;
      }

      div.image {
        position: relative;
        cursor: pointer;
        background-image: url(./mario.png);
        background-size: 100% 100%;
        background-repeat: no-repeat;
        background-position: center;
        width: 96px;
        height: 115px;
        top: -584px;
        left: 321px;
      }
    </style>
  </head>
  <h1><strong>Gallery</strong></h1>
  <body> 
      <div id="gallery">
        <!-- <div class="gallery-item">
          <div class="image"></div>
        </div> -->
      </div>
    <input type="file" id="attach" style="display: none" />
  </body>
  <script>
    // fetchë¥¼ ì‚¬ìš©í•˜ì—¬ ì•„ëž˜ ê²½ë¡œë¡œ ìš”ì²­í•˜ê¸°
    const thumbnail = document.querySelector("thumbnailUrl");
    const title = document.getElementById("title");

    // fetch(Promise)ë¡œ urlì„ ë¶ˆëŸ¬ì˜¤ê³  ë¹„ë™ê¸°ìž‘ì—… ì™„ë£Œì‹œì— .then ë©”ì„œë“œ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤
    // if  () => {} í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ responseì‘ë‹µ ì´ ë§Œì•½ ì‘ë‹´ì´ ì—†ê±°ë‚˜ ì‹¤íŒ¨í• ì‹œì—
    // throw ìƒˆë¡œìš´ ì—ëŸ¬ ë¥¼ ë°œìƒì‹œí‚¨ë‹¤ `` ìœ¼ë¡œ ê·¸ ê²°ê³¼ë¥¼ ë¬¸ìžì—´ë¡œ ì•Œë ¤ì¤€ë‹¤
    // ë¹„ë™ê¸° ìž‘ì—… ì™„ë£Œì‹œì—ëŠ” response ê°ì²´ì— json() í˜¸ì¶œ -> json í˜•ì‹ìœ¼ë¡œ íŒŒì‹± -> javascript ê°ì²´ë¡œ ë³€í™˜ í•´ì¤€ë‹¤
    fetch("https://jsonplaceholder.typicode.com/photos")
      .then((response) => {
        if (!response.ok) {
          throw new Error(`response: ${response.status}`);
        }
        return response.json();
      })
      // ë³€í™˜ ì‹œì¼œì¤€ ê°ì²´ë¥¼ .then (promise ë©”ì„œë“œí•¨ìˆ˜)ì— ê°€ì ¸ì˜¨ ê°’ì˜ ì´ë¦„ì„ photosìœ¼ë¡œ ì •ì˜ í•´ì£¼ê³ 
      // í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ photosì˜ ê¸¸ì´ê°€ 0 ì´ê±°ë‚˜ photos ê°’ì´ ì—†ë‹¤ë©´ ì—ëŸ¬ ì½”ë“œ none resultë¥¼ ë°˜í™˜í•´ì¤€ë‹¤
      .then((photos) => {
        if (!photos || photos.length == 0) {
          throw new Error("none result");
        }
        return photos.reverse().map((photo, i) => {
          return { title: photo.title, thumbnailUrl: photo.thumbnailUrl };
        });
      })
      .then((data) => {
        return data.slice(0, 10);
      })
      .then((data) => {
        const galleryElement = document.getElementById("gallery");
        data.forEach((item) => {
          const galleryItem = document.createElement("div");
          const thumbnailImg = document.createElement("img");
          const gallerytitle = document.createElement("p");
          thumbnailImg.src = item.thumbnailUrl;
          gallerytitle.innerHTML = item.title;
          galleryItem.classList.add("gallery-item");
          galleryItem.append(thumbnailImg);
          galleryItem.append(gallerytitle);
          galleryElement.append(galleryItem);
        });
      });

    const input = document.getElementById("attach");
    const iconimage = document.querySelector("div.image");
    input.addEventListener("change", (e) => {
      console.log("ì—…ë¡œë“œ! ðŸ˜");
      const reader = new FileReader();
      reader.readAsDataURL(e.target.files[0]);
      reader.onload = (e) => {
        cancel.style.display = "block";
        const path = e.target.result;
        if (path.includes("image")) {
          iconimage.style.backgroundImage = `url('${path}')`;
        } else {
          iconimage.style.backgroundImage = `url('./happy.png')`;
        }
      };
    });

    // https://jsonplaceholder.typicode.com/photos
    // ë°ì´í„° ì¤‘ ì¸ë„¤ì¼ì„ í™œìš©í•˜ì—¬ ëª©ë¡ì„ êµ¬ì„±í•˜ê¸°
    // ê° ë°ì´í„°ì˜ titleë„ ì¶œë ¥í•´ì£¼ê¸°
    // ì‚¬ìš©ìžê°€ ìš”ì²­í•œ íŽ˜ì´ì§€ì— ë§žê²Œ ë°ì´í„°ë¥¼ ì¶œë ¥í•´ì¤€ë‹¤.
    // í•œ íŽ˜ì´ì§€ë‹¹, 10ê°œì”© ì¶œë ¥ë˜ë©°
    // 3íŽ˜ì´ì§€ì¼ ê²½ìš° 21ë²ˆë¶€í„° 30ë²ˆê¹Œì§€ ì¶œë ¥ë˜ì–´ì•¼ í•œë‹¤.

    // í˜„ìž¬ íŽ˜ì´ì§€ * ê¸€ ê°œìˆ˜: limit
    // limit - í˜„ìž¬ íŽ˜ì´ì§€ - 1: offset

    // íŽ˜ì´ì§€ ë‹¨ìœ„ëŠ” 5ë‹¨ìœ„
    // Math.ceil(í˜„ìž¬ íŽ˜ì´ì§€ / íŽ˜ì´ì§€ ë‹¨ìœ„) * íŽ˜ì´ì§€ ë‹¨ìœ„: endPage
    // endPage - íŽ˜ì´ì§€ ë‹¨ìœ„ + 1: startPage
    // Math.ceil(ì „ì²´ ê°œìˆ˜ / íŽ˜ì´ì§€ ë‹¨ìœ„): realendpage
    // ìµœì‹ ìˆœìœ¼ë¡œ ì¶œë ¥
    console.log(
      new Array(10)
        .fill()
        .map((data, i) => i + 1)
        .slice(0, 5)
    );
  </script>
</html>
